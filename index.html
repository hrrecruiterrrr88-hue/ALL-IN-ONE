<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>All in One - كل الأدوات في مكان واحد</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Cairo&display=swap');
  * {
    box-sizing: border-box;
  }
  body {
    font-family: 'Cairo', sans-serif;
    background: #f0f2f5;
    margin: 0;
    padding: 0;
    color: #333;
  }
  header {
    background-color: #2c3e50;
    color: #ecf0f1;
    padding: 15px 20px;
    text-align: center;
    font-size: 1.8em;
    font-weight: 700;
  }
  nav {
    background: #34495e;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
  }
  nav button {
    background: transparent;
    border: none;
    color: #ecf0f1;
    padding: 10px 18px;
    cursor: pointer;
    font-size: 1em;
    transition: background-color 0.3s ease;
    flex-grow: 1;
    max-width: 160px;
  }
  nav button:hover, nav button.active {
    background-color: #2980b9;
  }
  main {
    max-width: 960px;
    margin: 20px auto;
    padding: 0 20px 40px 20px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 8px 24px rgba(0,0,0,0.1);
  }
  section {
    display: none;
    padding: 20px 10px;
  }
  section.active {
    display: block;
  }
  h2 {
    text-align: center;
    margin-bottom: 15px;
    color: #2980b9;
  }
  label {
    display: block;
    margin-top: 15px;
    font-weight: 600;
  }
  input[type=text],
  input[type=number],
  input[type=date],
  input[type=datetime-local],
  input[type=time],
  input[type=password],
  select,
  textarea {
    width: 100%;
    padding: 10px 8px;
    margin-top: 5px;
    border-radius: 6px;
    border: 1px solid #ccc;
    font-size: 1em;
    font-family: 'Cairo', sans-serif;
  }
  textarea {
    resize: vertical;
  }
  button.submit-btn {
    margin-top: 20px;
    padding: 12px 25px;
    font-weight: 700;
    background-color: #2980b9;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }
  button.submit-btn:hover {
    background-color: #1c5980;
  }
  .output {
    margin-top: 20px;
    background: #ecf0f1;
    padding: 15px;
    border-radius: 8px;
    white-space: pre-wrap;
    font-family: monospace;
  }
  /* Scrollable container for long outputs */
  .output.scrollable {
    max-height: 250px;
    overflow-y: auto;
  }
  /* Responsive */
  @media (max-width: 640px) {
    nav button {
      max-width: 100%;
      flex-grow: 1;
      font-size: 0.9em;
    }
  }
</style>
</head>
<body>

<header>All in One - كل الأدوات في مكان واحد</header>

<nav aria-label="قائمة الأدوات">
  <button class="nav-btn active" data-target="msgNotify">إشعار رسالة</button>
  <button class="nav-btn" data-target="dateConvert">تحويل التاريخ</button>
  <button class="nav-btn" data-target="currencyConvert">تحويل العملات</button>
  <button class="nav-btn" data-target="unitConvert">تحويل الوحدات</button>
  <button class="nav-btn" data-target="passwordGen">مولد كلمات السر</button>
  <button class="nav-btn" data-target="colorGen">مولد ألوان CSS</button>
  <button class="nav-btn" data-target="timezoneConvert">تحويل التوقيت</button>
  <button class="nav-btn" data-target="dictionary">قاموس عربي-إنجليزي</button>
  <button class="nav-btn" data-target="calculator">حاسبة بسيطة</button>
  <button class="nav-btn" data-target="randomNum">مولد أرقام عشوائية</button>
  <button class="nav-btn" data-target="currentTime">الوقت والتاريخ الحالي</button>
  <button class="nav-btn" data-target="textTransform">تحويل نص</button>
  <button class="nav-btn" data-target="funFacts">حقائق عامة</button>
  <button class="nav-btn" data-target="ageCalc">حساب العمر</button>
  <button class="nav-btn" data-target="bmiCalc">حاسبة BMI</button>
  <button class="nav-btn" data-target="loanCalc">حاسبة القروض</button>
  <button class="nav-btn" data-target="todoList">مخطط مهام</button>
  <button class="nav-btn" data-target="qrGen">مولد رموز QR</button>
  <button class="nav-btn" data-target="morseCode">مورورس كود</button>
  <button class="nav-btn" data-target="textToSpeech">نص إلى كلام</button>
</nav>

<main>

<!-- 1. إشعار رسالة -->
<section id="msgNotify" class="active" aria-label="إشعار رسالة">
  <h2>إرسال رسالة مع إشعار داخل المتصفح</h2>
  <form id="formNotify">
    <label for="notifyMessage">الرسالة</label>
    <textarea id="notifyMessage" rows="3" placeholder="اكتب رسالتك هنا..." required></textarea>
    <label for="notifyDateTime">تاريخ ووقت الإشعار</label>
    <input type="datetime-local" id="notifyDateTime" required />
    <button type="submit" class="submit-btn">حفظ الإشعار</button>
  </form>
  <div id="notifyFeedback" class="output" aria-live="polite"></div>
</section>

<!-- 2. تحويل التاريخ ميلادي/هجري -->
<section id="dateConvert" aria-label="تحويل التاريخ">
  <h2>تحويل التاريخ (ميلادي - هجري)</h2>
  <form id="formDateConvert">
    <label for="inputDate">اختر التاريخ الميلادي</label>
    <input type="date" id="inputDate" required />
    <button type="submit" class="submit-btn">تحويل إلى هجري</button>
  </form>
  <div id="dateConvertResult" class="output"></div>
</section>

<!-- 3. تحويل العملات -->
<section id="currencyConvert" aria-label="تحويل العملات">
  <h2>تحويل العملات</h2>
  <form id="formCurrencyConvert">
    <label for="currencyAmount">المبلغ</label>
    <input type="number" id="currencyAmount" min="0" step="0.01" value="1" required />
    <label for="currencyFrom">من</label>
    <select id="currencyFrom" required>
      <option value="USD">دولار أمريكي (USD)</option>
      <option value="EUR">يورو (EUR)</option>
      <option value="EGP">جنيه مصري (EGP)</option>
      <option value="SAR">ريال سعودي (SAR)</option>
      <option value="AED">درهم إماراتي (AED)</option>
      <option value="GBP">جنيه إسترليني (GBP)</option>
    </select>
    <label for="currencyTo">إلى</label>
    <select id="currencyTo" required>
      <option value="EGP">جنيه مصري (EGP)</option>
      <option value="USD">دولار أمريكي (USD)</option>
      <option value="EUR">يورو (EUR)</option>
      <option value="SAR">ريال سعودي (SAR)</option>
      <option value="AED">درهم إماراتي (AED)</option>
      <option value="GBP">جنيه إسترليني (GBP)</option>
    </select>
    <button type="submit" class="submit-btn">تحويل</button>
  </form>
  <div id="currencyResult" class="output"></div>
</section>

<!-- 4. تحويل الوحدات -->
<section id="unitConvert" aria-label="تحويل الوحدات">
  <h2>تحويل وحدات القياس</h2>
  <form id="formUnitConvert">
    <label for="unitCategory">اختر نوع الوحدة</label>
    <select id="unitCategory" required>
      <option value="">-- اختر --</option>
      <option value="length">الطول</option>
      <option value="weight">الوزن</option>
      <option value="volume">الحجم</option>
      <option value="temperature">الحرارة</option>
    </select>

    <div id="unitInputs" style="margin-top:15px; display:none;">
      <label for="unitFrom">من</label>
      <select id="unitFrom" required></select>

      <label for="unitTo">إلى</label>
      <select id="unitTo" required></select>

      <label for="unitValue">القيمة</label>
      <input type="number" id="unitValue" min="0" step="any" required />
      <button type="submit" class="submit-btn" style="margin-top:10px;">تحويل</button>
    </div>
  </form>
  <div id="unitResult" class="output"></div>
</section>

<!-- 5. مولد كلمات السر -->
<section id="passwordGen" aria-label="مولد كلمات السر">
  <h2>مولد كلمات السر القوية</h2>
  <form id="formPasswordGen">
    <label><input type="checkbox" id="useUpper" checked /> حروف كبيرة (A-Z)</label>
    <label><input type="checkbox" id="useLower" checked /> حروف صغيرة (a-z)</label>
    <label><input type="checkbox" id="useNumbers" checked /> أرقام (0-9)</label>
    <label><input type="checkbox" id="useSymbols" /> رموز خاصة (!@#$...)</label>
    <label for="passLength">طول كلمة السر</label>
    <input type="number" id="passLength" min="4" max="64" value="16" />
    <button type="submit" class="submit-btn">توليد كلمة السر</button>
  </form>
  <div id="passwordResult" class="output"></div>
</section>

<!-- 6. مولد ألوان CSS -->
<section id="colorGen" aria-label="مولد ألوان CSS">
  <h2>مولد ألوان CSS</h2>
  <form id="formColorGen">
    <label for="colorCount">عدد الألوان</label>
    <input type="number" id="colorCount" min="1" max="10" value="5" />
    <button type="submit" class="submit-btn">توليد</button>
  </form>
  <div id="colorResult" class="output scrollable"></div>
</section>

<!-- 7. تحويل الوقت بين المناطق الزمنية -->
<section id="timezoneConvert" aria-label="تحويل التوقيت">
  <h2>تحويل الوقت بين المناطق الزمنية</h2>
  <form id="formTimezoneConvert">
    <label for="timeInput">الوقت</label>
    <input type="time" id="timeInput" value="12:00" required />
    <label for="fromTZ">من المنطقة الزمنية</label>
    <select id="fromTZ" required></select>
    <label for="toTZ">إلى المنطقة الزمنية</label>
    <select id="toTZ" required></select>
    <button type="submit" class="submit-btn">تحويل</button>
  </form>
  <div id="timezoneResult" class="output"></div>
</section>

<!-- 8. قاموس عربي - إنجليزي صغير -->
<section id="dictionary" aria-label="قاموس عربي إنجليزي">
  <h2>قاموس عربي - إنجليزي صغير</h2>
  <form id="formDictionary">
    <label for="dictInput">أدخل كلمة بالعربية أو الإنجليزية</label>
    <input type="text" id="dictInput" placeholder="مثال: كتاب أو book" required />
    <button type="submit" class="submit-btn">ترجمة</button>
  </form>
  <div id="dictResult" class="output"></div>
</section>

<!-- 9. آلة حاسبة بسيطة -->
<section id="calculator" aria-label="آلة حاسبة بسيطة">
  <h2>آلة حاسبة بسيطة</h2>
  <form id="formCalculator">
    <label for="calcInput">أدخل العملية الحسابية (مثال: 5+6*2)</label>
    <input type="text" id="calcInput" placeholder="مثال: 12 / 3 + 7" required />
    <button type="submit" class="submit-btn">حساب</button>
  </form>
  <div id="calcResult" class="output"></div>
</section>

<!-- 10. مولد أرقام عشوائية -->
<section id="randomNum" aria-label="مولد أرقام عشوائية">
  <h2>مولد أرقام عشوائية</h2>
  <form id="formRandomNum">
    <label for="randomMin">الحد الأدنى</label>
    <input type="number" id="randomMin" value="1" required />
    <label for="randomMax">الحد الأقصى</label>
    <input type="number" id="randomMax" value="100" required />
    <button type="submit" class="submit-btn">توليد</button>
  </form>
  <div id="randomResult" class="output"></div>
</section>

<!-- 11. الوقت والتاريخ الحالي -->
<section id="currentTime" aria-label="الوقت والتاريخ الحالي">
  <h2>الوقت والتاريخ الحالي</h2>
  <div id="currentTimeDisplay" class="output" style="font-size:1.4em; text-align:center;"></div>
</section>

<!-- 12. تحويل نص (حروف كبيرة / صغيرة) -->
<section id="textTransform" aria-label="تحويل نص">
  <h2>تحويل النص</h2>
  <form id="formTextTransform">
    <label for="textInputTransform">أدخل النص</label>
    <textarea id="textInputTransform" rows="3" placeholder="اكتب هنا..." required></textarea>
    <label for="transformType">اختر نوع التحويل</label>
    <select id="transformType" required>
      <option value="upper">حروف كبيرة</option>
      <option value="lower">حروف صغيرة</option>
      <option value="capitalize">أول حرف من كل كلمة كبيرة</option>
    </select>
    <button type="submit" class="submit-btn">تحويل</button>
  </form>
  <div id="textTransformResult" class="output"></div>
</section>

<!-- 13. حقائق عامة -->
<section id="funFacts" aria-label="حقائق عامة">
  <h2>حقائق عامة</h2>
  <button id="btnFunFact" class="submit-btn">احصل على حقيقة جديدة</button>
  <div id="funFactOutput" class="output"></div>
</section>

<!-- 14. حساب العمر -->
<section id="ageCalc" aria-label="حساب العمر">
  <h2>حساب العمر</h2>
  <form id="formAgeCalc">
    <label for="birthDate">اختر تاريخ الميلاد</label>
    <input type="date" id="birthDate" required />
    <button type="submit" class="submit-btn">احسب العمر</button>
  </form>
  <div id="ageResult" class="output"></div>
</section>

<!-- 15. حاسبة مؤشر كتلة الجسم (BMI) -->
<section id="bmiCalc" aria-label="حاسبة BMI">
  <h2>حاسبة مؤشر كتلة الجسم (BMI)</h2>
  <form id="formBMICalc">
    <label for="bmiWeight">الوزن بالكيلوغرام</label>
    <input type="number" id="bmiWeight" min="1" step="any" required />
    <label for="bmiHeight">الطول بالسنتيمتر</label>
    <input type="number" id="bmiHeight" min="1" step="any" required />
    <button type="submit" class="submit-btn">احسب BMI</button>
  </form>
  <div id="bmiResult" class="output"></div>
</section>

<!-- 16. حاسبة القروض -->
<section id="loanCalc" aria-label="حاسبة القروض">
  <h2>حاسبة القروض والفوائد</h2>
  <form id="formLoanCalc">
    <label for="loanAmount">مبلغ القرض</label>
    <input type="number" id="loanAmount" min="1" step="any" required />
    <label for="loanInterest">نسبة الفائدة السنوية (%)</label>
    <input type="number" id="loanInterest" min="0" step="any" required />
    <label for="loanYears">مدة القرض (سنوات)</label>
    <input type="number" id="loanYears" min="1" step="1" required />
    <button type="submit" class="submit-btn">احسب القسط الشهري</button>
  </form>
  <div id="loanResult" class="output"></div>
</section>

<!-- 17. مخطط مهام (To-Do List) -->
<section id="todoList" aria-label="مخطط مهام">
  <h2>مخطط مهام To-Do List</h2>
  <form id="formTodo">
    <input type="text" id="todoInput" placeholder="أضف مهمة جديدة..." required />
    <button type="submit" class="submit-btn">أضف</button>
  </form>
  <ul id="todoItems" style="margin-top:20px; list-style:none; padding:0;"></ul>
</section>

<!-- 18. مولد رموز QR -->
<section id="qrGen" aria-label="مولد رموز QR">
  <h2>مولد رموز QR</h2>
  <form id="formQRGen">
    <label for="qrText">أدخل النص أو الرابط</label>
    <input type="text" id="qrText" placeholder="اكتب هنا..." required />
    <button type="submit" class="submit-btn">توليد رمز QR</button>
  </form>
  <div id="qrResult" style="text-align:center; margin-top:20px;"></div>
</section>

<!-- 19. مورورس كود -->
<section id="morseCode" aria-label="مورورس كود">
  <h2>تحويل نص إلى مورورس كود والعكس</h2>
  <form id="formMorseCode">
    <label for="morseInput">أدخل النص</label>
    <textarea id="morseInput" rows="3" placeholder="اكتب هنا..." required></textarea>
    <label for="morseMode">اختر العملية</label>
    <select id="morseMode" required>
      <option value="encode">تحويل إلى مورورس كود</option>
      <option value="decode">تحويل من مورورس كود إلى نص</option>
    </select>
    <button type="submit" class="submit-btn">تنفيذ</button>
  </form>
  <div id="morseResult" class="output"></div>
</section>

<!-- 20. نص إلى كلام -->
<section id="textToSpeech" aria-label="نص إلى كلام">
  <h2>تحويل النص إلى كلام</h2>
  <form id="formTextToSpeech">
    <label for="ttsInput">أدخل النص</label>
    <textarea id="ttsInput" rows="4" placeholder="اكتب هنا..." required></textarea>
    <button type="submit" class="submit-btn">تشغيل الصوت</button>
  </form>
</section>

</main>

<script>
  // --- التنقل بين الأقسام ---
  const navButtons = document.querySelectorAll('nav button.nav-btn');
  const sections = document.querySelectorAll('main section');

  navButtons.forEach(btn => {
    btn.addEventListener('click', () => {
      navButtons.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');

      const target = btn.dataset.target;
      sections.forEach(sec => {
        if(sec.id === target) sec.classList.add('active');
        else sec.classList.remove('active');
      });
    });
  });

  // --- 1. إشعار رسالة ---
  (function(){
    const form = document.getElementById('formNotify');
    const feedback = document.getElementById('notifyFeedback');

    function requestPermission(){
      if('Notification' in window && Notification.permission === 'default'){
        Notification.requestPermission();
      }
    }
    requestPermission();

    form.addEventListener('submit', e => {
      e.preventDefault();
      feedback.textContent = '';
      const message = form.notifyMessage.value.trim();
      const dateTime = form.notifyDateTime.value;

      if(!message){
        feedback.textContent = 'الرجاء كتابة رسالة.';
        return;
      }
      if(!dateTime){
        feedback.textContent = 'الرجاء اختيار تاريخ ووقت.';
        return;
      }
      if(Notification.permission !== 'granted'){
        feedback.textContent = 'يرجى السماح بالإشعارات من المتصفح.';
        return;
      }

      const notifyTime = new Date(dateTime);
      const now = new Date();

      if(notifyTime <= now){
        feedback.textContent = 'يرجى اختيار وقت مستقبلي.';
        return;
      }

      const diff = notifyTime - now;
      feedback.textContent = 'تم حفظ الإشعار. يجب أن يبقى الموقع مفتوحًا لتلقي الإشعار.';

      setTimeout(() => {
        new Notification('رسالة من All in One', {body: message});
      }, diff);

      form.reset();
    });
  })();

  // --- 2. تحويل التاريخ ميلادي إلى هجري (تقريبي) ---
  (function(){
    // حساب هجري تقريبي من الميلادي (خوارزمية مبسطة)
    function gregorianToHijri(gDate){
      const gYear = gDate.getFullYear();
      const gMonth = gDate.getMonth() + 1;
      const gDay = gDate.getDate();

      let jd = Math.floor((1461*(gYear+4800+Math.floor((gMonth-14)/12)))/4) +
               Math.floor((367*(gMonth-2-12*(Math.floor((gMonth-14)/12))))/12) -
               Math.floor((3*Math.floor((gYear+4900+Math.floor((gMonth-14)/12))/100))/4) + gDay - 32075;

      let l = jd - 1948440 + 10632;
      let n = Math.floor((l - 1) / 10631);
      l = l - 10631 * n + 354;
      let j = (Math.floor((10985 - l) / 5316)) * (Math.floor((50 * l) / 17719)) + (Math.floor(l / 5670)) * (Math.floor((43 * l) / 15238));
      l = l - (Math.floor((30 - j) / 15)) * (Math.floor((17719 * j) / 50)) - (Math.floor(j / 16)) * (Math.floor((15238 * j) / 43)) + 29;
      let m = Math.floor((24 * l) / 709);
      let d = l - Math.floor((709 * m) / 24);
      let y = 30 * n + j - 30;

      return {hYear: y, hMonth: m, hDay: d};
    }

    const form = document.getElementById('formDateConvert');
    const output = document.getElementById('dateConvertResult');

    form.addEventListener('submit', e => {
      e.preventDefault();
      const dateVal = form.inputDate.value;
      if(!dateVal){
        output.textContent = 'الرجاء اختيار تاريخ.';
        return;
      }
      const gDate = new Date(dateVal);
      const hijri = gregorianToHijri(gDate);
      output.textContent = `التاريخ الهجري التقريبي: ${hijri.hDay} / ${hijri.hMonth} / ${hijri.hYear}`;
    });
  })();

  // --- 3. تحويل العملات ---
  (function(){
    const form = document.getElementById('formCurrencyConvert');
    const output = document.getElementById('currencyResult');

    // أسعار ثابتة تقريبية (تحديث يدوي ممكن)
    const rates = {
      USD: 1,
      EUR: 1.05,
      EGP: 30,
      SAR: 3.75,
      AED: 3.67,
      GBP: 0.85
    };

    form.addEventListener('submit', e => {
      e.preventDefault();
      let amount = parseFloat(form.currencyAmount.value);
      const from = form.currencyFrom.value;
      const to = form.currencyTo.value;

      if(isNaN(amount) || amount < 0){
        output.textContent = 'الرجاء إدخال مبلغ صحيح.';
        return;
      }

      // تحويل المبلغ إلى الدولار ثم إلى العملة المطلوبة
      let usdAmount = amount / rates[from];
      let converted = usdAmount * rates[to];

      output.textContent = `${amount.toFixed(2)} ${from} = ${converted.toFixed(2)} ${to}`;
    });
  })();

  // --- 4. تحويل الوحدات ---
  (function(){
    const form = document.getElementById('formUnitConvert');
    const categorySelect = document.getElementById('unitCategory');
    const unitFromSelect = document.getElementById('unitFrom');
    const unitToSelect = document.getElementById('unitTo');
    const valueInput = document.getElementById('unitValue');
    const resultOutput = document.getElementById('unitResult');
    const unitInputsDiv = document.getElementById('unitInputs');

    // وحدات وأنواع التحويل
    const units = {
      length: {
        label: 'الطول',
        units: {
          meter: {name:'متر', toBase: v => v, fromBase: v => v},
          km: {name:'كيلومتر', toBase: v => v * 1000, fromBase: v => v / 1000},
          cm: {name:'سنتيمتر', toBase: v => v / 100, fromBase: v => v * 100},
          mm: {name:'ميليمتر', toBase: v => v / 1000, fromBase: v => v * 1000},
          inch: {name:'بوصة', toBase: v => v * 0.0254, fromBase: v => v / 0.0254},
          foot: {name:'قدم', toBase: v => v * 0.3048, fromBase: v => v / 0.3048},
          mile: {name:'ميل', toBase: v => v * 1609.34, fromBase: v => v / 1609.34},
        }
      },
      weight: {
        label: 'الوزن',
        units: {
          kg: {name:'كيلوجرام', toBase: v => v, fromBase: v => v},
          g: {name:'جرام', toBase: v => v / 1000, fromBase: v => v * 1000},
          mg: {name:'ميليجرام', toBase: v => v / 1e6, fromBase: v => v * 1e6},
          pound: {name:'رطل', toBase: v => v * 0.453592, fromBase: v => v / 0.453592},
          ounce: {name:'أوقية', toBase: v => v * 0.0283495, fromBase: v => v / 0.0283495},
        }
      },
      volume: {
        label: 'الحجم',
        units: {
          liter: {name:'لتر', toBase: v => v, fromBase: v => v},
          ml: {name:'ملليلتر', toBase: v => v / 1000, fromBase: v => v * 1000},
          cubicMeter: {name:'متر مكعب', toBase: v => v * 1000, fromBase: v => v / 1000},
          gallon: {name:'جالون (أمريكي)', toBase: v => v * 3.78541, fromBase: v => v / 3.78541},
          pint: {name:'بينت', toBase: v => v * 0.473176, fromBase: v => v / 0.473176},
        }
      },
      temperature: {
        label: 'الحرارة',
        units: {
          celsius: {name:'درجة مئوية', toBase: v => v, fromBase: v => v},
          fahrenheit: {name:'فهرنهايت', toBase: v => (v - 32) * 5/9, fromBase: v => (v * 9/5) + 32},
          kelvin: {name:'كلفن', toBase: v => v - 273.15, fromBase: v => v + 273.15},
        }
      }
    };

    // تهيئة القوائم عند اختيار الفئة
    categorySelect.addEventListener('change', () => {
      const cat = categorySelect.value;
      if (!cat) {
        unitInputsDiv.style.display = 'none';
        resultOutput.textContent = '';
        return;
      }
      unitInputsDiv.style.display = 'block';
      const u = units[cat].units;
      unitFromSelect.innerHTML = '';
      unitToSelect.innerHTML = '';
      for(let key in u){
        const optFrom = document.createElement('option');
        optFrom.value = key;
        optFrom.textContent = u[key].name;
        unitFromSelect.appendChild(optFrom);
        const optTo = optFrom.cloneNode(true);
        unitToSelect.appendChild(optTo);
      }
    });

    form.addEventListener('submit', e => {
      e.preventDefault();
      const cat = categorySelect.value;
      if(!cat){
        resultOutput.textContent = 'اختر نوع الوحدة أولاً.';
        return;
      }
      const from = unitFromSelect.value;
      const to = unitToSelect.value;
      let val = parseFloat(valueInput.value);
      if(isNaN(val)){
        resultOutput.textContent = 'ادخل قيمة صحيحة.';
        return;
      }
      if(from === to){
        resultOutput.textContent = 'الوحدة من وإلى متشابهة.';
        return;
      }
      const u = units[cat].units;
      const baseVal = u[from].toBase(val);
      const converted = u[to].fromBase(baseVal);
      resultOutput.textContent = `${val} ${u[from].name} = ${converted.toFixed(4)} ${u[to].name}`;
    });
  })();

  // --- 5. مولد كلمات السر ---
  (function(){
    const form = document.getElementById('formPasswordGen');
    const output = document.getElementById('passwordResult');

    form.addEventListener('submit', e => {
      e.preventDefault();
      const useUpper = form.useUpper.checked;
      const useLower = form.useLower.checked;
      const useNumbers = form.useNumbers.checked;
      const useSymbols = form.useSymbols.checked;
      let length = parseInt(form.passLength.value);

      if(!useUpper && !useLower && !useNumbers && !useSymbols){
        output.textContent = 'اختر نوع واحد على الأقل من الأحرف.';
        return;
      }
      if(isNaN(length) || length < 4){
        output.textContent = 'طول كلمة السر يجب أن يكون 4 أحرف على الأقل.';
        return;
      }
      if(length > 64) length = 64;

      const upperChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
      const lowerChars = 'abcdefghijklmnopqrstuvwxyz';
      const numberChars = '0123456789';
      const symbolChars = '!@#$%^&*()-_=+[]{}|;:,.<>?';

      let allChars = '';
      if(useUpper) allChars += upperChars;
      if(useLower) allChars += lowerChars;
      if(useNumbers) allChars += numberChars;
      if(useSymbols) allChars += symbolChars;

      let password = '';
      for(let i=0; i<length; i++){
        password += allChars.charAt(Math.floor(Math.random() * allChars.length));
      }
      output.textContent = password;
    });
  })();

  // --- 6. مولد ألوان CSS ---
  (function(){
    const form = document.getElementById('formColorGen');
    const output = document.getElementById('colorResult');

    form.addEventListener('submit', e => {
      e.preventDefault();
      let count = parseInt(form.colorCount.value);
      if(isNaN(count) || count < 1 || count > 10){
        output.textContent = 'اختر عدد من 1 إلى 10.';
        return;
      }
      let colors = '';
      for(let i=0; i<count; i++){
        let r = Math.floor(Math.random()*256);
        let g = Math.floor(Math.random()*256);
        let b = Math.floor(Math.random()*256);
        let hex = '#' + [r,g,b].map(x=>x.toString(16).padStart(2,'0')).join('');
        colors += `color${i+1}: ${hex};\n`;
      }
      output.textContent = colors;
    });
  })();

  // --- 7. تحويل الوقت بين المناطق الزمنية ---
  (function(){
    const form = document.getElementById('formTimezoneConvert');
    const output = document.getElementById('timezoneResult');
    const fromTZ = document.getElementById('fromTZ');
    const toTZ = document.getElementById('toTZ');

    // قائمة مناطق زمنية شائعة (قائمة مختصرة)
    const timezones = [
      'UTC',
      'Africa/Cairo',
      'Asia/Riyadh',
      'Asia/Dubai',
      'Europe/London',
      'Europe/Paris',
      'Europe/Berlin',
      'America/New_York',
      'America/Los_Angeles',
      'Asia/Tokyo',
      'Australia/Sydney',
    ];

    function populateTimezones(){
      timezones.forEach(tz => {
        let opt1 = document.createElement('option');
        opt1.value = tz;
        opt1.textContent = tz;
        fromTZ.appendChild(opt1);

        let opt2 = document.createElement('option');
        opt2.value = tz;
        opt2.textContent = tz;
        toTZ.appendChild(opt2);
      });
      fromTZ.value = 'UTC';
      toTZ.value = 'Africa/Cairo';
    }
    populateTimezones();

    form.addEventListener('submit', e => {
      e.preventDefault();
      const timeStr = form.timeInput.value;
      if(!timeStr){
        output.textContent = 'الرجاء إدخال وقت صالح.';
        return;
      }
      const fromZone = fromTZ.value;
      const toZone = toTZ.value;

      // باستخدام مكتبة Intl.DateTimeFormat لتحويل الوقت (تقريبي)
      try {
        // Parse الوقت مع المنطقة الزمنية "fromZone"
        // لتحويل الوقت نستخدم Date مع UTC ونحسب الفرق

        // الوقت في fromZone
        let [hours, minutes] = timeStr.split(':').map(Number);
        let baseDate = new Date(Date.UTC(2023,0,1,hours,minutes));

        // فرق التوقيت بين fromZone و toZone (تقديري)
        let fromOffset = -new Date().toLocaleString('en-US', {timeZone: fromZone, timeZoneName: 'short'}).split(' ').pop().replace('GMT','');
        let toOffset = -new Date().toLocaleString('en-US', {timeZone: toZone, timeZoneName: 'short'}).split(' ').pop().replace('GMT','');

        // لأن JavaScript لا تتيح حساب الفرق مباشرة, نبسط بحساب فرق الساعات
        // لكن ممكن يكون دقيق أكثر مع مكتبات خارجية (هنا لأسباب عملية)

        let diffHours = toOffset - fromOffset;
        let resultHours = (hours + diffHours + 24) % 24;

        output.textContent = `الوقت في ${toZone} هو ${String(resultHours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}`;
      } catch(err){
        output.textContent = 'حدث خطأ أثناء التحويل.';
      }
    });
  })();

  // --- 8. قاموس عربي - إنجليزي صغير (ثابت) ---
  (function(){
    const form = document.getElementById('formDictionary');
    const output = document.getElementById('dictResult');
    const dictionary = {
      'كتاب': 'Book',
      'قلم': 'Pen',
      'مدرسة': 'School',
      'سيارة': 'Car',
      'طائرة': 'Airplane',
      'hello': 'مرحبا',
      'car': 'سيارة',
      'computer': 'حاسوب',
      'phone': 'هاتف',
      'water': 'ماء'
    };

    form.addEventListener('submit', e => {
      e.preventDefault();
      let word = form.dictInput.value.trim().toLowerCase();
      if(!word){
        output.textContent = 'ادخل كلمة للترجمة.';
        return;
      }
      if(dictionary[word]){
        output.textContent = dictionary[word];
      } else {
        // البحث بالعكس
        let found = Object.entries(dictionary).find(([ar,en]) => en.toLowerCase() === word);
        if(found) {
          output.textContent = found[0];
        } else {
          output.textContent = 'الكلمة غير موجودة في القاموس.';
        }
      }
    });
  })();

  // --- 9. آلة حاسبة بسيطة ---
  (function(){
    const form = document.getElementById('formCalculator');
    const output = document.getElementById('calcResult');

    form.addEventListener('submit', e => {
      e.preventDefault();
      let expr = form.calcInput.value.trim();
      if(!expr){
        output.textContent = 'ادخل عملية حسابية.';
        return;
      }
      try {
        // أمان: منع تنفيذ أي كود غير الحساب الأساسي
        if(/[^-()\d/*+. \t]/.test(expr)){
          output.textContent = 'توجد رموز غير مسموح بها.';
          return;
        }
        let result = Function('"use strict";return (' + expr + ')')();
        output.textContent = `النتيجة: ${result}`;
      } catch(err){
        output.textContent = 'خطأ في العملية الحسابية.';
      }
    });
  })();

  // --- 10. مولد أرقام عشوائية ---
  (function(){
    const form = document.getElementById('formRandomNum');
    const output = document.getElementById('randomResult');

    form.addEventListener('submit', e => {
      e.preventDefault();
      let min = parseInt(form.randomMin.value);
      let max = parseInt(form.randomMax.value);
      if(isNaN(min) || isNaN(max)){
        output.textContent = 'ادخل أرقام صحيحة.';
        return;
      }
      if(min > max){
        output.textContent = 'الحد الأدنى أكبر من الحد الأقصى.';
        return;
      }
      let rand = Math.floor(Math.random() * (max - min + 1)) + min;
      output.textContent = `الرقم العشوائي: ${rand}`;
    });
  })();

  // --- 11. الوقت والتاريخ الحالي (تحديث كل ثانية) ---
  (function(){
    const display = document.getElementById('currentTimeDisplay');
    function updateTime(){
      const now = new Date();
      display.textContent = now.toLocaleString('ar-EG', {hour12:false});
    }
    updateTime();
    setInterval(updateTime, 1000);
  })();

  // --- 12. تحويل نص ---
  (function(){
    const form = document.getElementById('formTextTransform');
    const output = document.getElementById('textTransformResult');

    function capitalizeWords(str){
      return str.replace(/\b\w/g, c => c.toUpperCase());
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      let text = form.textInputTransform.value;
      let mode = form.transformType.value;
      let result = '';
      switch(mode){
        case 'upper': result = text.toUpperCase(); break;
        case 'lower': result = text.toLowerCase(); break;
        case 'capitalize': result = capitalizeWords(text); break;
        default: result = text;
      }
      output.textContent = result;
    });
  })();

  // --- 13. حقائق عامة ---
  (function(){
    const facts = [
      'العسل لا يفسد أبداً.',
      'الأخطبوط لديه ثلاثة قلوب.',
      'الشمس أكبر من الأرض بحوالي 109 مرات في القطر.',
      'الدماغ البشري يحتوي على حوالي 86 مليار خلية عصبية.',
      'اللغة العربية تحتوي على أكثر من 12 مليون كلمة.',
      'البركان يطلق غازات ساخنة تصل إلى 1200 درجة مئوية.',
      'الأسد هو الحيوان الوحيد الذي يملك عرفاً.',
      'القطط تنام حوالي 16 ساعة في اليوم.',
      'الزهور تستهلك ثاني أكسيد الكربون في النهار وتنتج الأكسجين.',
      'البشر يستطيعون تمييز أكثر من 10 آلاف لون مختلف.'
    ];
    const btn = document.getElementById('btnFunFact');
    const output = document.getElementById('funFactOutput');
    btn.addEventListener('click', () => {
      let fact = facts[Math.floor(Math.random() * facts.length)];
      output.textContent = fact;
    });
  })();

  // --- 14. حساب العمر ---
  (function(){
    const form = document.getElementById('formAgeCalc');
    const output = document.getElementById('ageResult');

    form.addEventListener('submit', e => {
      e.preventDefault();
      let birthDateStr = form.birthDate.value;
      if(!birthDateStr){
        output.textContent = 'اختر تاريخ الميلاد.';
        return;
      }
      let birthDate = new Date(birthDateStr);
      let now = new Date();

      if(birthDate > now){
        output.textContent = 'تاريخ الميلاد لا يمكن أن يكون في المستقبل.';
        return;
      }

      let ageYears = now.getFullYear() - birthDate.getFullYear();
      let ageMonths = now.getMonth() - birthDate.getMonth();
      let ageDays = now.getDate() - birthDate.getDate();

      if(ageDays < 0){
        ageMonths--;
        ageDays += new Date(now.getFullYear(), now.getMonth(), 0).getDate();
      }
      if(ageMonths < 0){
        ageYears--;
        ageMonths += 12;
      }
      output.textContent = `العمر: ${ageYears} سنة، ${ageMonths} شهر، و${ageDays} يوم.`;
    });
  })();

  // --- 15. حاسبة BMI ---
  (function(){
    const form = document.getElementById('formBMICalc');
    const output = document.getElementById('bmiResult');

    form.addEventListener('submit', e => {
      e.preventDefault();
      const weight = parseFloat(form.bmiWeight.value);
      const heightCm = parseFloat(form.bmiHeight.value);

      if(isNaN(weight) || weight <= 0 || isNaN(heightCm) || heightCm <= 0){
        output.textContent = 'أدخل قيم صحيحة.';
        return;
      }
      const heightM = heightCm / 100;
      const bmi = weight / (heightM * heightM);
      let category = '';
      if(bmi < 18.5) category = 'نقص وزن';
      else if(bmi < 25) category = 'وزن طبيعي';
      else if(bmi < 30) category = 'زيادة وزن';
      else category = 'سمنة';

      output.textContent = `BMI = ${bmi.toFixed(2)} (${category})`;
    });
  })();

  // --- 16. حاسبة القروض ---
  (function(){
    const form = document.getElementById('formLoanCalc');
    const output = document.getElementById('loanResult');

    form.addEventListener('submit', e => {
      e.preventDefault();
      const principal = parseFloat(form.loanAmount.value);
      const annualInterest = parseFloat(form.loanInterest.value) / 100;
      const years = parseInt(form.loanYears.value);

      if(isNaN(principal) || principal <= 0 || isNaN(annualInterest) || annualInterest < 0 || isNaN(years) || years <= 0){
        output.textContent = 'أدخل قيم صحيحة.';
        return;
      }
      const monthlyInterest = annualInterest / 12;
      const months = years * 12;
      let monthlyPayment;
      if(monthlyInterest === 0){
        monthlyPayment = principal / months;
      } else {
        monthlyPayment = principal * monthlyInterest / (1 - Math.pow(1 + monthlyInterest, -months));
      }
      output.textContent = `القسط الشهري: ${monthlyPayment.toFixed(2)} (لمدة ${months} شهراً)`;
    });
  })();

  // --- 17. مخطط مهام ---
  (function(){
    const form = document.getElementById('formTodo');
    const input = document.getElementById('todoInput');
    const list = document.getElementById('todoItems');

    // استرجاع المهام من localStorage
    let todos = JSON.parse(localStorage.getItem('todos') || '[]');
    function renderTodos(){
      list.innerHTML = '';
      todos.forEach((todo, i) => {
        const li = document.createElement('li');
        li.textContent = todo;
        li.style.padding = '8px 10px';
        li.style.borderBottom = '1px solid #ddd';
        li.style.cursor = 'pointer';
        li.title = 'انقر لحذف المهمة';
        li.addEventListener('click', () => {
          todos.splice(i,1);
          localStorage.setItem('todos', JSON.stringify(todos));
          renderTodos();
        });
        list.appendChild(li);
      });
    }
    renderTodos();

    form.addEventListener('submit', e => {
      e.preventDefault();
      const val = input.value.trim();
      if(val){
        todos.push(val);
        localStorage.setItem('todos', JSON.stringify(todos));
        renderTodos();
        input.value = '';
      }
    });
  })();

  // --- 18. مولد رموز QR ---
  (function(){
    const form = document.getElementById('formQRGen');
    const output = document.getElementById('qrResult');

    // استخدام مكتبة خارجية من cdn (QR Code Generator)
    // لأن طلبك بدون سيرفر - سنستخدم API مجاني عبر jsdelivr

    // تحميل سكريبت QRCode
    function loadScript(src, callback){
      const script = document.createElement('script');
      script.src = src;
      script.onload = callback;
      document.head.appendChild(script);
    }

    loadScript('https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js', () => {
      form.addEventListener('submit', e => {
        e.preventDefault();
        const text = form.qrText.value.trim();
        if(!text){
          output.textContent = 'ادخل نصًا أو رابطًا.';
          return;
        }
        output.innerHTML = '';
        const canvas = document.createElement('canvas');
        output.appendChild(canvas);

        QRCode.toCanvas(canvas, text, {width:200}, err => {
          if(err) output.textContent = 'خطأ في توليد رمز QR.';
        });
      });
    });
  })();

  // --- 19. مورورس كود ---
  (function(){
    const form = document.getElementById('formMorseCode');
    const output = document.getElementById('morseResult');

    const morseMap = {
      'a':'.-','b':'-...','c':'-.-.','d':'-..','e':'.',
      'f':'..-.','g':'--.','h':'....','i':'..','j':'.---',
      'k':'-.-','l':'.-..','m':'--','n':'-.','o':'---',
      'p':'.--.','q':'--.-','r':'.-.','s':'...','t':'-',
      'u':'..-','v':'...-','w':'.--','x':'-..-','y':'-.--',
      'z':'--..',
      '0':'-----','1':'.----','2':'..---','3':'...--','4':'....-',
      '5':'.....','6':'-....','7':'--...','8':'---..','9':'----.',
      ' ':'/'
    };

    function encodeMorse(text){
      return text.toLowerCase().split('').map(c => morseMap[c] || '').join(' ');
    }
    function decodeMorse(code){
      const revMap = Object.entries(morseMap).reduce((obj,[k,v])=> (obj[v]=k,obj),{});
      return code.split(' ').map(c => revMap[c] || '').join('');
    }

    form.addEventListener('submit', e => {
      e.preventDefault();
      const text = form.morseInput.value.trim();
      if(!text){
        output.textContent = 'ادخل نصًا أو كود مورورس.';
        return;
      }
      const mode = form.morseMode.value;
      if(mode === 'encode'){
        output.textContent = encodeMorse(text);
      } else {
        output.textContent = decodeMorse(text);
      }
    });
  })();

  // --- 20. نص إلى كلام ---
  (function(){
    const form = document.getElementById('formTextToSpeech');
    form.addEventListener('submit', e => {
      e.preventDefault();
      const text = form.ttsInput.value.trim();
      if(!text){
        alert('ادخل نصاً.');
        return;
      }
      if(!('speechSynthesis' in window)){
        alert('الميزة غير مدعومة في هذا المتصفح.');
        return;
      }
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.lang = 'ar-SA'; // العربية السعودية - يمكنك تغييره حسب الرغبة
      window.speechSynthesis.speak(utterance);
    });
  })();

</script>

</body>
</html>
